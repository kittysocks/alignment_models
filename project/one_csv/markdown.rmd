---
title: "Plots Pertaining to Data Properties of Alignments"
author: "Molly Miraglia"
---
Hello, welcome to my R markdown file, this is example text.


```{r setup, include = FALSE}
library(tidyverse)
library(magrittr)
```
## Analysis of Data
Below, I have my csv file, named "one_csv.csv" read by R, and imported into the markdown. I will be using the file to create plots!

```{r, include = FALSE}
one_csv <- read_csv(file="one_csv.csv")
```

```{r}
one_csv
```
I will be running one_csv.csv through the function, ggplot, to create plots, from the tidyverse package.

Disclaimer: In my data, there is missing data, as there were errors creating trees.Therefore, the tidyverse function 'drop_na' has been used to remove "NA" from my plots.

#Plot One! - A Test!
```{r}
one_csv %>%
  drop_na %>%
  ggplot(aes(x =mean_seq_length, y = number_models)) + 
  geom_point(alpha = 0.6, aes(color = data_type)) +
  scale_color_manual("Data Type",labels=c("aa","nt"),values=c('pink2','lightskyblue')) +
  theme(legend.key=element_rect(color="goldenrod", fill = "ivory1"),legend.background = element_rect(fill="pink", color = "grey")) +
  scale_x_continuous(name= "Mean Sequence Length") +
  scale_y_continuous(name="Number of Models per Dataset")
```

This plot can virtually be ignored, it was meant to be a test. I enjoyed picking out the colors though. Time for the real deal (faceting!)


#Plot Two - Starting to Facet!

The following plot will be Number of Models per Dataset per Mean Sequence Length.

```{r}
one_csv %>%
  drop_na() %>%
  ggplot(aes(x=mean_seq_length,y=number_models)) +
  geom_point() + 
  facet_grid(ic_type ~data_type)
```
Alright, so that plot has all the faceting it needs, but it's boring! Let's add colors and change around the axis titles and maybe even the legend! Perhaps I will even give the plot a title ohohhoh.


```{r}

one_csv %>%
  drop_na() %>%
  ggplot(aes(x=mean_seq_length,y=number_models)) +
  geom_point(aes(color=data_type)) + 
  facet_grid(ic_type ~data_type) +
  scale_x_continuous(name="Mean Sequence Length") +
  scale_y_continuous(name="Number of Models per Dataset") +
  scale_color_manual(labels=c("aa","nt"),values=c("palevioletred","cornflowerblue")) +
  theme(legend.key=element_rect(fill="ivory3")) +
  scale_fill_discrete(name="Data Type",breaks=c("aa","nt"),labels=c("Amino Acid Data","Nucleotide Data"))
  
  
```

Ok I've been trying to change the faceting labels, was using `labeller` function, but to no avail. Will be giving up now.

Ok, I tried using the `labeller` on November 7th. It is now November 10th. 

Back to plotting!


```{r}

one_csv %>%
  drop_na() %>%
  ggplot(aes(x=mean_seq_length,y=number_models)) +
  geom_point(aes(color=data_type)) + 
  facet_grid(ic_type ~data_type) +
  scale_x_continuous(name="Mean Sequence Length") +
  scale_y_continuous(name="Number of Models per Dataset") +
  scale_color_manual("Data Type",labels=c("aa","nt"),values=c("palevioletred","cornflowerblue")) +
  theme(legend.key=element_rect(fill="ivory3"), plot.title=element_text(hjust=0.5)) +
  scale_fill_discrete(labels=c("Amino Acid Data","Nucleotide Data")) +
  ggtitle("Mean Sequence Lengthh and Number of Models per Dataset of Selectome Data")
  
  
```

Added a title, and am still trying to change label names. Not sure why they won't change when I'm using `scale_fill_discrete` and the `label=c()` function. 

# Plot Three - Exploring More Aspects of Data!

```{r}
one_csv %>%
  drop_na() %>%
  ggplot(aes(x=min_seq_length,y=number_models)) +
  geom_point() +
  facet_grid(ic_type ~data_type)
```

# Plot Four - Tree Length and Number of Models

```{r}
one_csv %>%
  drop_na() %>%
  ggplot(aes(x=tree_length,y=number_models)) +
  geom_point()+
  scale_colour_brewer(palette="Set1") +
  facet_grid(ic_type~data_type)
```

So the above is the normal, boring scatterpot we've been plotting. Going to explore different plots down under. All plots are not final, but will always need work and editing on them!

```{r}
one_csv%>%
  drop_na() %>%
  ggplot(aes(y=stdev_seq_length,x=number_models, group=number_models)) +
  geom_violin() +
  ggtitle("Tree Length and Number of Models") +
  scale_x_continuous(name="Number of Models per Dataset") +
  scale_y_continuous(name="Tree Length") +
  theme(plot.title=element_text(hjust=0.5)) +
  scale_fill_brewer(palette="Greens") +
  facet_wrap(ic_type~data_type, scales='free_y')
```

#Plot Five - Amino Acid and Nucleotide Number of Models

##Here is an example why we can't just use spread, the plot will not be plotted!

```{r}
#amino acids vs nucleotides - number of models
#change dimensions of the data, aa = x, nt = y

test_one_csv <- one_csv %>%
  drop_na() %>%
  spread(data_type,number_models)

  #separate(name,c("ic_type","data_type"),sep="/")

test_one_csv %>%
  ggplot(aes(x=aa,y=nt)) +
  geom_point()

```



## Nothing was plotted!

###Now we will try to use `separate()` 



``` {r}

test_2 <- one_csv %>%
  drop_na() %>%
  pivot_wider(names_from = data_type,values_from = number_models) %>%
  mutate(dummyvar=name) %>% 
  separate(name,into=c("name1","name2"),sep=".nt")
  
  
  filter() 
  separate(name,into=c("name1","name2"),sep=".") 
  

  
  #str_replace_all(test_2$name,".nt","") %>%
  #separate(name,into=c("name1","name2"), sep=".")

```






