filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000000948.Euteleostomi.003.aa.fas"
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000003140.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000009532.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000009798.Euteleostomi.002.aa.fas"
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
unique(aa_ranked_models$name) %>%
group_by(name,number, ic_type) %>%
spread(name, Model) %>%
ungroup()
unique(aa_ranked_models$name) %>%
group_by(name,number, ic_type)
unique(aa_ranked_models$name) %>%
spread(name, Model) %>%
ungroup()
unique(aa_ranked_models) %>%
spread(name, Model)
unique(aa_ranked_models) %>%
group_by(name, Model)
unique(aa_ranked_models) %>%
filter(Model = 3)
unique(aa_ranked_models) %>%
filter(Model == 3)
unique(aa_ranked_models$Model)
unique(aa_ranked_models) %>%
filter(Model == "WAG+G4", "JTT+G4", "HIVb+G4")
unique(aa_ranked_models$name) %>%
filter(Model)
unique(aa_ranked_models$name) %>%
filter()
unique(aa_ranked_models) %>%
filter(Model)
unique(aa_ranked_models) %>%
group_by(Model)
unique(aa_ranked_models) %>%
group_by(name, Model)
unique(aa_ranked_models$name) %>%
group_by(name, Model)
unique(aa_ranked_models$name) %>%
select()
distinct(aa_ranked_models$name)
distinct(aa_ranked_models)
unique(aa_ranked_models$name)
for(unique(aa_ranked_models$name)) {
read_lines()
}
for unique(aa_ranked_models$name) {
read_lines()
}
for unique(aa_ranked_models$name)
read_lines()
read_lines()
unique(aa_ranked_models$name) %>%
read_lines()
unique(aa_ranked_models$name) %>%
read_line()
unique(aa_ranked_models$name) %>%
readline()
unique(aa_ranked_models$name) %>%
print (readline(), counter + 1)
for (unique) {
print (readline(), counter = counter + 1) }
unique(aa_ranked_models$name) %>%
readline()
unique(aa_ranked_models$name) %>%
readlines()
unique(aa_ranked_models$name) %>%
read_lines_raw()
unique(aa_ranked_models$name) %>%
readLines()
unique(aa_ranked_models$name) %>%
read_lines_chunked()
unique(aa_ranked_models$name) %>%
read_lines_raw_chunked()
unique(aa_ranked_models$name)
aa3_unique = "ENSGT00390000016613.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000008279.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000008991.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000009905.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000005295.Euteleostomi.002.aa.fas"
### three model
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000017365.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000016529.Euteleostomi.002.aa.fas"
### three model
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
x = "JTT+G4"
unique(aa_ranked_models$name) %>%
filter(Model == x)
unique(aa_ranked_models) %>%
filter(Model == x)
unique(aa_ranked_models) %>%
filter(Model == x, y)
y = "WAG+G4"
unique(aa_ranked_models) %>%
filter(Model == x, y)
unique(aa_ranked_models) %>%
filter(Model == x & y)
unique(aa_ranked_models) %>%
filter(Model == x + y)
unique(aa_ranked_models) %>%
filter(Model == x && y)
uniq(aa_ranked_models$Model)
unique(aa_ranked_models$Model)
unique(aa_ranked_models) %>%
filter(Model == x || y)
unique(aa_ranked_models) %>%
filter(Model == y)
x = "JTT+G4 WAG+G4"
unique(aa_ranked_models) %>%
filter(Model == x)
x = "ENSGT00390000008279.Euteleostomi.001.aa.fas"
unique(aa_ranked_models) %>%
filter(name == x)
### three model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
unique(aa_ranked_models)
aa_ranked_models
unique(aa_ranked_models$name)
unique(aa_ranked_models$name)
test = "ENSGT00390000018612.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
two_model = "ENSGT00390000018612.Euteleostomi.001.aa.fas"
### three model
aa_ranked_models %>%
filter(name == two_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00510000046928.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000013494.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000008279.Euteleostomi.001.aa.fas"
### two model
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa3_unique = "ENSGT00390000013494.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
unique(aa_ranked_models$Model)
unique(aa_ranked_models$name)
test = "ENSGT00390000011821.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00530000063045.Euteleostomi.006.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00530000062987.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
function (x, y, ...)
test = "ENSGT00520000055580.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00530000062974.Euteleostomi.004.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
print test, i = i + 1 )
print (test, i = i + 1 )
test = "ENSGT00530000062974.Euteleostomi.004.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
print (test)
i = 1
for (name in unique(aa_ranked_models$name)) {
test = name
print (test)
}
print (test, i == i + 1)
i = 1
for (name in unique(aa_ranked_models$name)) {
test = name
print (test, i == i + 1)
}
i = 1
for (name in unique(aa_ranked_models$name)) {
test = name
count(print (test, i == i + 1))
}
test = "ENSGT00390000000018.Euteleostomi.003.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00530000063045.Euteleostomi.006.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000016655.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa_ranked_models %>%
filter(name = test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
name
readline()
readline()
for (name in unique(aa_ranked_models$name)) {
readline()
}
library(tidyverse)
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
unique(aa_ranked_models$name)
for (name in unique(aa_ranked_models$name)) {
readlines()
}
for (name in unique(aa_ranked_models$name)) {
read_lines()
}
for (name in unique(aa_ranked_models$name)) {
readline(name)
}
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000000018.Euteleostomi.003.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
library(tidyverse)
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
### three model
aa3_unique = "ENSGT00390000013494.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == aa3_unique) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
library(tidyverse)
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
library(tidyverse)
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
test = "ENSGT00390000000018.Euteleostomi.003.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
unique(aa_ranked_models$name)
test = "ENSGT00390000013581.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
test = "ENSGT00390000005703.Euteleostomi.001.aa.fas"
aa_ranked_models %>%
filter(name == test) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
nt_ranked_models <- process_all_csv(nt_path)
unique(nt_ranked_models)
unique(nt_ranked_models$name)
hell = "ENSGT00510000047024.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00390000008002.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00390000001046.Euteleostomi.005.nt.fas"
### 6 models nt
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00390000008002.Euteleostomi.001.nt.fas"
### 6 models
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
six_model = "ENSGT00390000008002.Euteleostomi.001.nt.fas"
### 6 models
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
unique(nt_ranked_models$name)
hell = "ENSGT00390000000455.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00440000037877.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00390000017673.Euteleostomi.002.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00510000046400.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00490000043360.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00390000010947.Euteleostomi.003.nt.fa"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00390000010947.Euteleostomi.003.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00510000046929.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
hell = "ENSGT00410000025793.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
three_model = "ENSGT00410000025793.Euteleostomi.001.nt.fas"
nt_ranked_models %>%
filter(name == three_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic()
### one model
nt_ranked_models %>%
filter(name == one_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments")
one_model = "ENSGT00390000000455.Euteleostomi.001.nt.fas"
### one model
nt_ranked_models %>%
filter(name == one_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments")
### 6 models
nt_ranked_models %>%
filter(name == hell) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments")
six_nt_model = "ENSGT00390000008002.Euteleostomi.001.nt.fas"
### 6 models
nt_ranked_models %>%
filter(name == six_nt_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments")
### one model
nt_ranked_models %>%
filter(name == one_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments") -> one_nt_model
ggsave("one_nt_model.pdf", one_nt_model)
### three model
nt_ranked_models %>%
filter(name == three_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments") -> three_nt_model
ggsave("three_nt_model.pdf", three_nt_model)
### 6 models
nt_ranked_models %>%
filter(name == six_nt_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments") -> nt_six_model
ggsave("six_nt_model.pdf)", nt_six_model
ggsave("six_nt_model.pdf)", nt_six_model)
ggsave("six_nt_model.pdf", nt_six_model)
cols2 <- c("AIC" = "firebrick2", "AICc" = "darkorchid3", "BIC" = "lightsalmon2")
nt_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name, fill = ic_type)) +
geom_col(color = "black") +
ggtitle("Nucleotide Model Selection") +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic()  + scale_y_continuous(expand=c(0,0), name = "Number of Datasets", limits = c(0, 125)) +
scale_x_continuous(name = "Number of Models per Dataset") +
scale_fill_manual(values = cols2) +
theme(legend.position = "none", plot.title = element_text(hjust = 0.5)) -> num_nt_models_plot
nt_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name, fill = ic_type)) +
geom_col(color = "black") +
ggtitle("Nucleotide Model Selection") +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic()  + scale_y_continuous(expand=c(0,0), name = "Number of Datasets", limits = c(0, 125)) +
scale_x_continuous(name = "Number of Models per Dataset") +
scale_fill_manual(values = cols2) +
theme(legend.position = "none", plot.title = element_text(hjust = 0.5))
ggsave("num_nt_plot.pdf", num_nt_models_plot) # add args like width = .., height = ..
### 6 models
nt_ranked_models %>%
filter(name == six_nt_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments") -> nt_six_model
nt_ranked_models %>%
filter(name == six_nt_model) %>%
ggplot(aes(x = Model, fill = ic_type)) + geom_bar(position = position_dodge()) + theme_classic() +
scale_y_continuous(name = "Number of Alignments")
