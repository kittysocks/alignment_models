tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic() + panel_border() -> num_models_plot
## Wrangles data and then makes plot where x = number of models and y = number of datasets, faceted by IC.
### This shows us how many models are selected for each datasets where a dataset=50 alignment versions
### colors!!!
ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic() -> num_models_plot
ranked_models %>%
filter(ic_type == "BIC") -> ranked_models_bic
## Wrangles data and then makes plot where x = number of models and y = number of datasets, faceted by IC.
### This shows us how many models are selected for each datasets where a dataset=50 alignment versions
### colors!!!
ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic() -> num_models_plot
### baaaad
ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
aa_ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
nt_ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
library(tidyverse)
c
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
library(tidyverse)
library(tidyverse)
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
nt_ranked_models <- process_all_csv(nt_path)
aa_ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
plot(1:10, 1:10)
aa_ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
nt_ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
plot(1:10, 1:10)
nt_ranked_models %>%
ggplot(aes(x = Model, fill = Model)) + geom_bar() + theme_classic() + theme(legend.position = "none") + facet_grid(name~ic_type)
library(tidyverse)
## This function converts a directory of CSV files containing model selection information into a single tibble for all replicates
## NOTE: Assumes that the following headers are in each CSV: No.,Model,-LnL,df,AIC,AICc,BIC
## NOTE: Assumes each file is named <name>_alnversion_<number>_models.csv
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
library(tidyverse)
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
nt_ranked_models <- process_all_csv(nt_path)
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic() -> num_models_plot
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n)
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n)
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name))
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col()
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type)
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic() -> num_models_plot
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic()
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic() -> num_models_plot
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic()
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic()
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic() -> num_aa_models_plot
nt_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic()
nt_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name))+
facet_wrap(~ic_type) +
theme_classic() -> num_nt_models_plot
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name, color = "black")) +
geom_col() +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic()
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col(color = "black") +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic()
aa_ranked_models %>%
group_by(name, Model, ic_type) %>%
tally() %>%
ungroup() %>%
select(-n) %>%
group_by(name, ic_type) %>%
tally() %>%
rename(number_models = n ) %>%
group_by(number_models, ic_type) %>%
tally() %>%
rename(name = n) %>%
ggplot(aes(x = number_models, y = name)) +
geom_col(color = "black") +
geom_text(aes(x = number_models, y = name + 1, label = name)) +
facet_wrap(~ic_type) +
theme_classic()
ggsave("output.pdf", num_nt_models_plot) # add args like width = .., height = .
getwd
getwd()
library(tidyverse)
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
## This function converts a directory of CSV files containing model selection information into a single tibble for all replicates
## NOTE: Assumes that the following headers are in each CSV: No.,Model,-LnL,df,AIC,AICc,BIC
## NOTE: Assumes each file is named <name>_alnversion_<number>_models.csv
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
nt_ranked_models <- process_all_csv(nt_path)
library(tidyverse)
## This function converts a directory of CSV files containing model selection information into a single tibble for all replicates
## NOTE: Assumes that the following headers are in each CSV: No.,Model,-LnL,df,AIC,AICc,BIC
## NOTE: Assumes each file is named <name>_alnversion_<number>_models.csv
process_all_csv <- function(path_to_csv)
{
# List of all csv files in the given directory
files <- dir(path = path_to_csv, pattern = "*.csv")
tibble(filename = files) %>%
mutate(file_contents = map(filename,
~ read_csv(file.path(path_to_csv, .)))) %>%
unnest() %>%
separate(filename, c("name", "dummy", "number", "dummy2"), sep="_") %>%
dplyr::select(-dummy, -dummy2, -No., -`-LnL`, -df) %>%
gather(ic_type, ic_value, AIC, AICc, BIC) %>%
group_by(name, number, ic_type) %>%
mutate(ic_rank = rank(ic_value)) %>%
filter(ic_rank == 1) %>%
ungroup() %>%
dplyr::select(name, number, Model, ic_type) -> ranked_models
ranked_models
}
aa_path <- "selectome_aa_output/"
nt_path <- "selectome_nt_output/"
aa_ranked_models <- process_all_csv(aa_path)
